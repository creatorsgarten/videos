WEBVTT

00:00:01.000 --> 00:00:08.000
สวัสดีครับทุกคน ผมพรพัฒน์ จาก DevForward เป็น Software Engineer ครับ

00:00:08.000 --> 00:00:13.000
ขออภัยในความไม่สะดวกทางเทคนิคด้วยนะครับ

00:00:13.000 --> 00:00:15.000
โอเค สไลด์ต่อไปครับ

00:00:15.000 --> 00:00:22.000
ปกติแล้ว ถ้าคุณต้องการสร้างแอปพลิเคชันมือถือหรือเดสก์ท็อป คุณต้องมีส่วนนี้ใช่ไหมครับ

00:00:22.000 --> 00:00:25.000
ในกรณีนี้ เป็นโปรเจกต์จริง

00:00:25.000 --> 00:00:27.000
ในกรณีนี้ ผมใช้ Flutter

00:00:27.000 --> 00:00:31.000
สิ่งที่สองที่คุณต้องคิดคือ backend

00:00:31.000 --> 00:00:32.000
คุณต้องสร้าง API

00:00:32.000 --> 00:00:37.000
ดังนั้น Supabase อาจเป็นคำตอบ

00:00:37.000 --> 00:00:39.000
ใช่ คุณเตรียมที่จะใช้ Supabase

00:00:39.000 --> 00:00:47.000
สิ่งที่คาดหวังคือ คุณต้องการดึงข้อมูลบางอย่างผ่าน API จาก database

00:00:47.000 --> 00:00:49.000
แต่ในกรณีนี้ คุณมีระบบเดิม

00:00:49.000 --> 00:00:54.000
ผมหมายถึง ระบบเดิม เช่น ระบบรายงาน

00:00:54.000 --> 00:00:55.000
สไลด์ต่อไปครับ

00:00:55.000 --> 00:01:01.000
นี่เป็นเหมือนโมดูลแบบดั้งเดิม

00:01:01.000 --> 00:01:08.000
มีคนในบริษัทสร้างมันขึ้นมาเมื่อนานมาแล้ว และมันยังคงมีประโยชน์อยู่

00:01:08.000 --> 00:01:15.000
ดังนั้น ในกรณีนี้ โมดูลนี้มีอยู่แล้ว แต่โมดูลใหม่ยังไม่มี

00:01:15.000 --> 00:01:24.000
ดังนั้น ผมอยากจะใช้ Supabase ในกรณีนี้

00:01:24.000 --> 00:01:27.000
ใช่ ใช่ ใช่ ในกรณีนี้ ใช่

00:01:27.000 --> 00:01:31.000
บางคนคิดว่าคุณสามารถใช้สถาปัตยกรรมนี้ได้

00:01:31.000 --> 00:01:38.000
ก็คือถ้าคุณต้องการ master data ก็ร้องขอผ่าน API แรก

00:01:38.000 --> 00:01:47.000
และถ้าคุณต้องการสร้างไฟล์รายงาน ก็เรียก API ที่สอง

00:01:47.000 --> 00:01:53.000
คุณสามารถทำได้ แต่สำหรับการ authentication การกำหนดสิทธิ์ต่างๆ คุณต้องควบคุมสิ่งนี้

00:01:53.000 --> 00:01:56.000
ในกรณีนี้ ผมพยายามรวมเข้าด้วยกัน

00:01:56.000 --> 00:02:00.000
ระบบนี้ทำงานบน DirectAdmin อยู่แล้ว

00:02:00.000 --> 00:02:03.000
มันเป็นระบบที่มีอยู่แล้ว

00:02:03.000 --> 00:02:10.000
ดังนั้น วิธีแก้ปัญหาของผมคือการรวมสองสิ่งเข้าด้วยกัน และตั้งค่าให้ทำงานร่วมกันอย่างราบรื่น

00:02:10.000 --> 00:02:11.000
นี่คือประเด็น

00:02:11.000 --> 00:02:13.000
ดังนั้น สไลด์ต่อไปครับ

00:02:13.000 --> 00:02:16.000
โอเค มาถึงรูปนี้

00:02:16.000 --> 00:02:28.000
สำหรับแอปพลิเคชันมือถือ แอปพลิเคชันเดสก์ท็อป หรือแอปพลิเคชันใดๆ คุณสามารถรับ master data หรือสิ่งอื่นๆ ผ่าน Supabase

00:02:28.000 --> 00:02:35.000
และคุณยังสามารถสร้าง edge function และเรียก edge function ผ่าน Supabase ได้

00:02:35.000 --> 00:02:47.000
และคุณสามารถใช้ฟีเจอร์ Supabase เช่น JWT authentication ได้อย่างที่คุณได้เรียนรู้ในหัวข้อก่อนหน้านี้

00:02:47.000 --> 00:02:54.000
และคุณยังสามารถเก็บระบบเดิมไว้เบื้องหลังได้

00:02:54.000 --> 00:03:01.000
ในการทำเช่นนี้ เราจะตั้งค่าเล็กน้อย

00:03:01.000 --> 00:03:08.000
อย่างแรก เรามีเซิร์ฟเวอร์สำหรับ DirectAdmin อยู่แล้ว

00:03:08.000 --> 00:03:15.000
ดังนั้น สองสิ่งที่เราต้องทำคือ อย่างแรก ติดตั้ง Docker ลงในเซิร์ฟเวอร์ DirectAdmin

00:03:15.000 --> 00:03:20.000
และคุณใช้ Docker Compose เพื่อติดตั้ง Supabase

00:03:20.000 --> 00:03:24.000
มันง่ายถ้าคุณทำตามขั้นตอนบนเว็บไซต์

00:03:24.000 --> 00:03:26.000
ต่อไปครับ

00:03:26.000 --> 00:03:29.000
ใช่ คุณต้องทำสองสิ่ง

00:03:29.000 --> 00:03:33.000
โอเค อันนี้ผมคัดลอกมาจากเอกสารประกอบของ Supabase

00:03:33.000 --> 00:03:35.000
ดังนั้น คุณเพียงแค่ทำตามนี้

00:03:35.000 --> 00:03:41.000
อย่างแรก เพียงไปที่เซิร์ฟเวอร์ DirectAdmin ของคุณ ผมหมายถึง เซิร์ฟเวอร์ VM ของคุณ

00:03:41.000 --> 00:03:45.000
จากนั้นคุณ clone repo ของ Supabase

00:03:45.000 --> 00:03:59.000
ประการที่สอง คุณไปที่โฟลเดอร์ Docker คุณคัดลอกไฟล์ environment และทำตามคำแนะนำในเอกสารประกอบ ตัวอย่างเช่น private key

00:03:59.000 --> 00:04:06.000
และสิ่งสุดท้าย เพียงแค่ Docker Compose pull และ Docker up

00:04:06.000 --> 00:04:08.000
โอเค ต่อไป

00:04:08.000 --> 00:04:20.000
จากจุดนี้ คุณจะได้รับทุกสิ่งที่ Supabase สามารถทำได้ผ่าน API นี้

00:04:20.000 --> 00:04:27.000
dashboard คุณสามารถเข้าถึงได้ผ่าน IP ของคุณและพอร์ต 8000

00:04:27.000 --> 00:04:30.000
คุณสามารถเข้าถึง dashboard ได้

00:04:30.000 --> 00:04:38.000
และ API อื่นๆ ตัวอย่างเช่น REST API สำหรับการเชื่อมต่อกับ database การ authentication การจัดเก็บข้อมูล real-time

00:04:38.000 --> 00:04:40.000
และสุดท้ายคือ function

00:04:40.000 --> 00:04:54.000
ถ้าคุณเขียน edge function และใส่ไว้ใน volume ของ Supabase คุณสามารถเรียก local function ผ่าน Supabase API ได้เช่นกัน

00:04:54.000 --> 00:05:00.000
โอเค และนี่คือจุดที่ DirectAdmin เข้ามาช่วย

00:05:00.000 --> 00:05:06.000
เพราะ DirectAdmin สามารถควบคุมไฟล์ config ได้

00:05:06.000 --> 00:05:19.000
เพราะอันนี้มีอยู่แล้ว ดังนั้น ผมจึงใช้ DirectAdmin เพื่อแก้ไข nginx ที่เชื่อมต่อ Supabase API และ DirectAdmin API

00:05:19.000 --> 00:05:26.000
นี่คือสคริปต์ แต่มันง่ายมาก

00:05:26.000 --> 00:05:28.000
คุณเพียงแค่ดูสองสิ่ง

00:05:28.000 --> 00:05:34.000
สิ่งแรก คุณเพียงแค่ map ตำแหน่งของแต่ละ API ของ Supabase

00:05:34.000 --> 00:05:37.000
แล้วคุณ forward ทุกอย่างไปที่ Kong

00:05:37.000 --> 00:05:42.000
Kong อยู่ที่นี่ มันอยู่บนพอร์ต 8000

00:05:42.000 --> 00:05:43.000
ดังนั้น คุณทำเช่นนี้

00:05:43.000 --> 00:05:49.000
ซึ่งหมายความว่าคุณสามารถเรียกทุกอย่างจาก Supabase API ได้แล้ว

00:05:49.000 --> 00:05:52.000
แต่อันนี้เป็นพิเศษสำหรับระบบเดิม

00:05:52.000 --> 00:05:54.000
คุณเพียงแค่ remap มันเล็กน้อย

00:05:54.000 --> 00:05:57.000
ใช่ ต่อไป

00:05:57.000 --> 00:06:00.000
โอเค ภาพรวมอยู่ที่นี่

00:06:00.000 --> 00:06:04.000
ใช่ ปกติแล้ว DirectAdmin สามารถควบคุมอันนี้ได้

00:06:04.000 --> 00:06:06.000
มันเป็นระบบเดิม

00:06:06.000 --> 00:06:13.000
แต่มันง่ายมากถ้าคุณต้องการสร้าง sub-website หรือ sub-system

00:06:13.000 --> 00:06:23.000
คุณจะทำเป็นเว็บโฮสติ้งด้วยวิธีแบบดั้งเดิมก็ได้

00:06:23.000 --> 00:06:30.000
แต่อันนี้เป็นแบบใหม่ ที่เราเชื่อมต่อก่อนหน้านี้

00:06:30.000 --> 00:06:47.000
ครับ โอเค ตอนนี้ คุณสามารถเชื่อมต่อกับ Supabase ด้วยชื่อโดเมนได้ เพราะโดยพื้นฐานแล้ว Supabase ให้เฉพาะที่อยู่ IP คุณสามารถเข้าถึงได้ผ่านที่อยู่ IP

00:06:47.000 --> 00:06:59.000
แต่เมื่อคุณกำหนดค่าด้วยวิธีนี้ คุณสามารถเชื่อมต่อ Supabase ผ่านโดเมนได้ เพราะ DirectAdmin จะจัดการโดเมน DNS และ HTTPS

00:06:59.000 --> 00:07:04.000
และยัง forward ทุกอย่างไปยัง container ของ Supabase

00:07:04.000 --> 00:07:09.000
ดังนั้น คุณสามารถเข้าถึงได้ และคุณสามารถเห็น dashboard ที่นี่

00:07:09.000 --> 00:07:10.000
และต่อไป

00:07:10.000 --> 00:07:18.000
นี่คือ edge function เพราะคุณต้องการเรียกตัวสร้างรายงาน

00:07:18.000 --> 00:07:21.000
มันเป็นไฟล์ PDF

00:07:21.000 --> 00:07:26.000
แต่ไฟล์ PDF ควรอยู่เบื้องหลัง Supabase API

00:07:26.000 --> 00:07:42.000
ดังนั้น ในอันนี้ เราเขียนสคริปต์ขนาดเล็กเพื่อรับคำขอผ่าน Supabase แล้วส่งต่อไปยังระบบเดิม

00:07:42.000 --> 00:07:43.000
แบบนี้

00:07:43.000 --> 00:07:50.000
นี่คือวิธีที่คุณเรียกระบบเดิมตามปกติ

00:07:50.000 --> 00:07:54.000
แล้วคุณส่ง header authorization ไปยังระบบเดิม

00:07:54.000 --> 00:08:01.000
และถ้าการตอบสนองของระบบเดิมไม่ใช่ 200 — สไลด์ต่อไปครับ

00:08:01.000 --> 00:08:07.000
คุณเพียงแค่ส่งทุกอย่างกลับเป็นการตอบสนอง

00:08:07.000 --> 00:08:14.000
ด้วยวิธีนี้ คุณสามารถร้องขอไฟล์ PDF ผ่าน Supabase API ได้เช่นกัน

00:08:14.000 --> 00:08:19.000
ทุกอย่างดูเหมือนว่าจะเรียกใช้งานผ่าน Supabase

00:08:19.000 --> 00:08:24.000
คุณไม่สามารถเข้าถึง API เบื้องหลังได้ตรงๆ

00:08:24.000 --> 00:08:33.000
โอเค และนี่คือแอปพลิเคชัน หรือแอปพลิเคชันมือถือ ที่แสดงบนมือถือหรือแอปพลิเคชัน

00:08:33.000 --> 00:08:34.000
ใช่ พนักงานใช้มัน

00:08:34.000 --> 00:08:36.000
และนี่คือรายงาน

00:08:36.000 --> 00:08:43.000
ถ้าคุณเรียก API สำหรับแอปพลิเคชันมือถือ คุณจะได้รับไฟล์ PDF

00:08:43.000 --> 00:08:51.000
และคุณไม่จำเป็นต้องสนใจระบบเบื้องหลังที่เชื่อมต่อกับระบบเดิมนี้เลย

00:08:51.000 --> 00:08:56.000
คุณเพียงแค่ส่ง ID หรือข้อมูลที่จำเป็นให้มันก็พอ

00:08:56.000 --> 00:08:59.000
ใช่ แค่นี้แหละ

00:08:59.000 --> 00:09:00.000
ขอบคุณครับ
